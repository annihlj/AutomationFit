<!doctype html>
<html lang="de">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Fragebogen – Entscheidungsunterstützung (RPA vs. IPA)</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <div class="container">
        <div class="topbar">
            <div>
                <h1>Entscheidungsunterstützung: RPA vs. IPA</h1>
                <p class="lead">Bitte erfassen Sie den Anwendungsfall und beantworten Sie die Fragen.
                    Pflichtfelder sind mit <span class="req">*</span> gekennzeichnet.</p>
            </div>
            <span class="badge">{{ questionnaire.name }} • v{{ questionnaire.version }}</span>
        </div>

        <form class="card" method="post" action="{{ url_for('evaluate') }}">

            <!-- 1) Use-Case Metadaten -->
            <fieldset>
                <legend>Anwendungsfall</legend>
                <div class="grid grid-2">
                    <div>
                        <label for="uc_name">Bezeichnung <span class="req">*</span></label>
                        <input id="uc_name" name="uc_name" type="text" placeholder="z. B. Eingangsrechnungen prüfen"
                            required />
                    </div>
                    <div>
                        <label for="industry">Branche</label>
                        <input id="industry" name="industry" type="text"
                            placeholder="z. B. Fertigung, Handel, Dienstleistung" />
                    </div>
                </div>

                <label for="uc_desc">Kurzbeschreibung <span class="req">*</span></label>
                <textarea id="uc_desc" name="uc_desc"
                    placeholder="Ziel, Ablauf in groben Schritten, beteiligte Systeme" required></textarea>
            </fieldset>

            <!-- 2) Dynamische Dimensionen und Fragen aus Datenbank -->
            {% for dimension in dimensions %}
            <fieldset style="margin-top:1.5rem">
                <legend>{{ dimension.code }}. {{ dimension.name }}</legend>

                {% for question in dimension.questions %}
                <div style="margin-bottom:1.5rem; padding:1rem; background:#f9fafb; border-radius:0.5rem">
                    <label style="font-weight:600; display:block; margin-bottom:0.5rem">
                        {{ question.code }} - {{ question.text }}
                        <span class="req">*</span>
                    </label>

                    {% if question.type == 'number' %}
                    <!-- Numerische Eingabe -->
                    <input type="number" step="0.01" name="q_{{ question.id }}" 
                           placeholder="Wert eingeben{% if question.unit %} ({{ question.unit }}){% endif %}" 
                           required style="max-width:300px">
                    {% if question.unit %}
                    <span style="margin-left:0.5rem; color:#6b7280">{{ question.unit }}</span>
                    {% endif %}

                    {% elif question.type == 'single_choice' %}
                    <!-- Single Choice mit Radio Buttons -->
                    <div style="display:flex; flex-direction:column; gap:0.5rem; margin-top:0.5rem">
                        {% for option in question.options %}
                        <label style="display:flex; align-items:center; gap:0.5rem; cursor:pointer; padding:0.5rem; background:white; border-radius:0.25rem; border:1px solid #e5e7eb">
                            <input type="radio" name="q_{{ question.id }}" value="{{ option.id }}" 
                                   required {% if option.is_na %}style="margin-right:0.25rem"{% endif %}>
                            <span>{{ option.label }}</span>
                        </label>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}

            </fieldset>
            {% endfor %}

            <div class="actions">
                <button type="reset" class="secondary">Zurücksetzen</button>
                <button type="submit">Bewertung berechnen</button>
            </div>
        </form>
    </div>
</body>

</html>
